var p=function(e){return typeof e==="string"?document.createTextNode(e):e};function n(e,o,...r){const[t,...s]=e.split("."),i=document.createElement(t||"div");if(i.className=s.join(" "),o instanceof HTMLElement||typeof o==="string")i.append(p(o));else if(o)for(let c in o){const a=o[c];if(typeof a==="function")i[c]=a;else i.setAttribute(c,a)}for(let c of r)if(c)i.appendChild(p(c));return i}class d extends HTMLElement{index;constructor(e,o){super();this.index=e,this.append(n("xc-controller-wrapper",n("xc-controller-header",o),n("xc-controller",n("xc-dpad",n("xc-dpad-up"),n("xc-dpad-right"),n("xc-dpad-down"),n("xc-dpad-left")),n("xc-select"),n("xc-start"),n("xc-buttons",n("xc-button-up"),n("xc-button-right"),n("xc-button-down"),n("xc-button-left")),n("xc-stick-left"),n("xc-stick-right"),n("xc-trigger-bottom-left"),n("xc-trigger-bottom-right"),n("xc-trigger-top-left"),n("xc-trigger-top-right"))))}connectedCallback(){const e=(t,s,...i)=>{this.querySelector(s)?.classList.toggle("xc-active",i.some((c)=>t.buttons[c]?.pressed))},o=(t,s,i)=>{const c=this.querySelector(t);c.style.setProperty("--x",`${s}`),c.style.setProperty("--y",`${i}`)},r=()=>{const t=navigator.getGamepads()[this.index];if(!t?.connected)return;if(this.isConnected)window.requestAnimationFrame(r);this.querySelector("xc-controller-header").textContent=t.id,e(t,"xc-button-down",0),e(t,"xc-button-right",1),e(t,"xc-button-left",2),e(t,"xc-button-up",3),e(t,"xc-trigger-top-left",4),e(t,"xc-trigger-bottom-left",6),e(t,"xc-trigger-top-right",5),e(t,"xc-trigger-bottom-right",7),e(t,"xc-select",8),e(t,"xc-start",9),e(t,"xc-stick-left",10),e(t,"xc-stick-right",11),e(t,"xc-dpad-up",12),e(t,"xc-dpad-down",13),e(t,"xc-dpad-left",14),e(t,"xc-dpad-right",15),o("xc-stick-left",t.axes[0],t.axes[1]),o("xc-stick-right",t.axes[2],t.axes[3])};window.requestAnimationFrame(r)}disconnectedCallback(){}}customElements.define("xc-gamepad-diagnostic",d);class l extends HTMLElement{instructions=n("xc-instructions","Connect one or more controllers and press any button to get started...");constructor(){super();this.append(this.instructions)}onGamepadConnected=(e)=>{this.instructions.remove(),this.append(new d(e.gamepad.index,e.gamepad.id))};onGamepadDisconnected=(e)=>{const o=this.querySelectorAll("xc-gamepad-diagnostic");for(let r of o)if(r.index===e.gamepad.index){r.remove();break}if(!this.querySelector("xc-gamepad-diagnostic"))this.append(this.instructions)};connectedCallback(){window.addEventListener("gamepadconnected",this.onGamepadConnected),window.addEventListener("gamepaddisconnected",this.onGamepadDisconnected)}disconnectedCallback(){window.removeEventListener("gamepadconnected",this.onGamepadConnected),window.removeEventListener("gamepaddisconnected",this.onGamepadDisconnected)}}customElements.define("xc-controllers",l);document.querySelector("main").append(new l);
